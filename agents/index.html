
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="..">
      
      
        <link rel="next" href="../environments/">
      
      
        
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Agents - Adala Docs</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.484c7ddc.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#adala.agents.base" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Adala Docs" class="md-header__button md-logo" aria-label="Adala Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Adala Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Agents
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/humansignal/Adala" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    humansignal/Adala
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="./" class="md-tabs__link">
        
  
  
    
  
  Agents

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../environments/" class="md-tabs__link">
        
  
  
    
  
  Environments

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../memories/" class="md-tabs__link">
        
  
  
    
  
  Memories

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../runtimes/" class="md-tabs__link">
        
  
  
    
  
  Runtimes

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../skills/" class="md-tabs__link">
        
  
  
    
  
  Skills

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../utils/" class="md-tabs__link">
        
  
  
    
  
  Utils

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Adala Docs" class="md-nav__button md-logo" aria-label="Adala Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Adala Docs
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/humansignal/Adala" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    humansignal/Adala
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Agents
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Agents
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#adala.agents.base" class="md-nav__link">
    <span class="md-ellipsis">
      
        base
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adala.agents.base.Agent" class="md-nav__link">
    <span class="md-ellipsis">
      
        Agent
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Agent">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#adala.agents.base.Agent.__rich__" class="md-nav__link">
    <span class="md-ellipsis">
      
        __rich__
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adala.agents.base.Agent.arefine_skill" class="md-nav__link">
    <span class="md-ellipsis">
      
        arefine_skill
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adala.agents.base.Agent.arun" class="md-nav__link">
    <span class="md-ellipsis">
      
        arun
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adala.agents.base.Agent.environment_validator" class="md-nav__link">
    <span class="md-ellipsis">
      
        environment_validator
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adala.agents.base.Agent.get_runtime" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_runtime
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adala.agents.base.Agent.get_teacher_runtime" class="md-nav__link">
    <span class="md-ellipsis">
      
        get_teacher_runtime
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adala.agents.base.Agent.learn" class="md-nav__link">
    <span class="md-ellipsis">
      
        learn
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adala.agents.base.Agent.run" class="md-nav__link">
    <span class="md-ellipsis">
      
        run
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adala.agents.base.Agent.runtimes_validator" class="md-nav__link">
    <span class="md-ellipsis">
      
        runtimes_validator
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adala.agents.base.Agent.select_skill_to_train" class="md-nav__link">
    <span class="md-ellipsis">
      
        select_skill_to_train
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adala.agents.base.Agent.skills_validator" class="md-nav__link">
    <span class="md-ellipsis">
      
        skills_validator
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adala.agents.base.Agent.verify_input_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      
        verify_input_parameters
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adala.agents.base.create_agent_from_dict" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_agent_from_dict
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adala.agents.base.create_agent_from_file" class="md-nav__link">
    <span class="md-ellipsis">
      
        create_agent_from_file
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../environments/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Environments
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../memories/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Memories
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../runtimes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Runtimes
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../skills/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Skills
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Utils
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/humansignal/Adala/tree/main/docs/src/agents.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  


  <h1>Agents</h1>

<div class="doc doc-object doc-module">



<a id="adala.agents.base"></a>
    <div class="doc doc-contents first">










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h2 id="adala.agents.base.Agent" class="doc doc-heading">
            <code>Agent</code>


</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="pydantic.BaseModel">BaseModel</span></code>, <code><span title="abc.ABC">ABC</span></code></p>



        <p>Represents a customizable agent that can interact with environments,
employ skills, and leverage memory and runtimes.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="adala.agents.base.Agent.environment">environment</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Environment (adala.environments.base.Environment)" href="../environments/#adala.environments.base.Environment">Environment</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The environment with which the agent interacts.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="adala.agents.base.Agent.skills">skills</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="SkillSet (adala.skills.skillset.SkillSet)" href="../skills/#adala.skills.skillset.SkillSet">SkillSet</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The skills possessed by the agent.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="adala.agents.base.Agent.memory">memory</span></code></td>
            <td>
                  <code><span title="LongTermMemory">LongTermMemory</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The agent's long-term memory. Defaults to None.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="adala.agents.base.Agent.runtimes">runtimes</span></code></td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <a class="autorefs autorefs-internal" title="Runtime (adala.runtimes.base.Runtime)" href="../runtimes/#adala.runtimes.base.Runtime">Runtime</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The runtimes available to the agent. Defaults to predefined runtimes.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="adala.agents.base.Agent.default_runtime">default_runtime</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The default runtime used by the agent. Defaults to 'openai'.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="adala.agents.base.Agent.teacher_runtimes">teacher_runtimes</span></code></td>
            <td>
                  <code><span title="typing.Dict">Dict</span>[<span title="str">str</span>, <a class="autorefs autorefs-internal" title="Runtime (adala.runtimes.base.Runtime)" href="../runtimes/#adala.runtimes.base.Runtime">Runtime</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The runtimes available to the agent's teacher. Defaults to predefined runtimes.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="adala.agents.base.Agent.default_teacher_runtime">default_teacher_runtime</span></code></td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The default runtime used by the agent's teacher. Defaults to 'openai-gpt3'.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">adala.environments</span><span class="w"> </span><span class="kn">import</span> <span class="n">StaticEnvironment</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">adala.skills</span><span class="w"> </span><span class="kn">import</span> <span class="n">LinearSkillSet</span><span class="p">,</span> <span class="n">TransformSkill</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">adala.agents</span><span class="w"> </span><span class="kn">import</span> <span class="n">Agent</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">agent</span> <span class="o">=</span> <span class="n">Agent</span><span class="p">(</span><span class="n">skills</span><span class="o">=</span><span class="n">LinearSkillSet</span><span class="p">(</span><span class="n">skills</span><span class="o">=</span><span class="p">[</span><span class="n">TransformSkill</span><span class="p">()]),</span> <span class="n">environment</span><span class="o">=</span><span class="n">StaticEnvironment</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">agent</span><span class="o">.</span><span class="n">learn</span><span class="p">()</span>  <span class="c1"># starts the learning process</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">predictions</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>  <span class="c1"># runs the agent and returns the predictions</span>
</code></pre></div>








              <details class="mkdocstrings-source">
                <summary>Source code in <code>adala/agents/base.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Agent</span><span class="p">(</span><span class="n">BaseModel</span><span class="p">,</span> <span class="n">ABC</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Represents a customizable agent that can interact with environments,</span>
<span class="sd">    employ skills, and leverage memory and runtimes.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        environment (Environment): The environment with which the agent interacts.</span>
<span class="sd">        skills (SkillSet): The skills possessed by the agent.</span>
<span class="sd">        memory (LongTermMemory, optional): The agent&#39;s long-term memory. Defaults to None.</span>
<span class="sd">        runtimes (Dict[str, Runtime], optional): The runtimes available to the agent. Defaults to predefined runtimes.</span>
<span class="sd">        default_runtime (str): The default runtime used by the agent. Defaults to &#39;openai&#39;.</span>
<span class="sd">        teacher_runtimes (Dict[str, Runtime], optional): The runtimes available to the agent&#39;s teacher. Defaults to predefined runtimes.</span>
<span class="sd">        default_teacher_runtime (str): The default runtime used by the agent&#39;s teacher. Defaults to &#39;openai-gpt3&#39;.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; from adala.environments import StaticEnvironment</span>
<span class="sd">        &gt;&gt;&gt; from adala.skills import LinearSkillSet, TransformSkill</span>
<span class="sd">        &gt;&gt;&gt; from adala.agents import Agent</span>
<span class="sd">        &gt;&gt;&gt; agent = Agent(skills=LinearSkillSet(skills=[TransformSkill()]), environment=StaticEnvironment())</span>
<span class="sd">        &gt;&gt;&gt; agent.learn()  # starts the learning process</span>
<span class="sd">        &gt;&gt;&gt; predictions = agent.run()  # runs the agent and returns the predictions</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">environment</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">SerializeAsAny</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Environment</span><span class="p">,</span> <span class="n">AsyncEnvironment</span><span class="p">]]]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">skills</span><span class="p">:</span> <span class="n">SerializeAsAny</span><span class="p">[</span><span class="n">SkillSet</span><span class="p">]</span>

    <span class="n">memory</span><span class="p">:</span> <span class="n">Memory</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">runtimes</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">SerializeAsAny</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Runtime</span><span class="p">,</span> <span class="n">AsyncRuntime</span><span class="p">]]]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="n">OpenAIChatRuntime</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s2">&quot;gpt-3.5-turbo&quot;</span><span class="p">)}</span>
    <span class="p">)</span>
    <span class="n">default_runtime</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;default&quot;</span>
    <span class="n">teacher_runtimes</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">SerializeAsAny</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="n">Runtime</span><span class="p">,</span> <span class="n">AsyncRuntime</span><span class="p">]]]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span>
        <span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;default&quot;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>
    <span class="p">)</span>
    <span class="n">default_teacher_runtime</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;default&quot;</span>

    <span class="k">class</span><span class="w"> </span><span class="nc">Config</span><span class="p">:</span>
        <span class="n">arbitrary_types_allowed</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__rich__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a colorized and formatted representation of the Agent instance.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: A rich-formatted representation of the agent.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">skill_names</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">skill</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">skill</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">skills</span><span class="o">.</span><span class="n">skills</span><span class="o">.</span><span class="n">values</span><span class="p">()])</span>
        <span class="n">runtime_names</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">runtimes</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;[bold blue]Agent Instance[/bold blue]</span><span class="se">\n\n</span><span class="s2">&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;Environment: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;Skills: </span><span class="si">{</span><span class="n">skill_names</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;Runtimes: </span><span class="si">{</span><span class="n">runtime_names</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;Default Runtime: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">default_runtime</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;Default Teacher Runtime: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">default_teacher_runtime</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="nd">@field_validator</span><span class="p">(</span><span class="s2">&quot;environment&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;before&quot;</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">environment_validator</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Environment</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Validates and possibly transforms the environment attribute:</span>
<span class="sd">        if the environment is an InternalDataFrame, it is transformed into a StaticEnvironment.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Validating environment attribute: </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">InternalDataFrame</span><span class="p">):</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">StaticEnvironment</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">v</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">and</span> <span class="s2">&quot;type&quot;</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
            <span class="n">v</span> <span class="o">=</span> <span class="n">Environment</span><span class="o">.</span><span class="n">create_from_registry</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">),</span> <span class="o">**</span><span class="n">v</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">v</span>

    <span class="nd">@field_validator</span><span class="p">(</span><span class="s2">&quot;skills&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;before&quot;</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">skills_validator</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SkillSet</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Validates and possibly transforms the skills attribute.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">SkillSet</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">v</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">Skill</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">LinearSkillSet</span><span class="p">(</span><span class="n">skills</span><span class="o">=</span><span class="p">[</span><span class="n">v</span><span class="p">])</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">LinearSkillSet</span><span class="p">(</span><span class="n">skills</span><span class="o">=</span><span class="n">v</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;skills must be of type SkillSet or Skill, but received type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

    <span class="nd">@field_validator</span><span class="p">(</span><span class="s2">&quot;runtimes&quot;</span><span class="p">,</span> <span class="s2">&quot;teacher_runtimes&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;before&quot;</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">runtimes_validator</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">Runtime</span><span class="p">,</span> <span class="n">AsyncRuntime</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Validates and creates runtimes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">out</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">runtime_name</span><span class="p">,</span> <span class="n">runtime_value</span> <span class="ow">in</span> <span class="n">v</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">runtime_value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="k">if</span> <span class="s2">&quot;type&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">runtime_value</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;Runtime </span><span class="si">{</span><span class="n">runtime_name</span><span class="si">}</span><span class="s2"> must have a &#39;type&#39; field to specify the runtime type.&quot;</span>
                    <span class="p">)</span>
                <span class="n">type_name</span> <span class="o">=</span> <span class="n">runtime_value</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span>
                <span class="n">runtime_value</span> <span class="o">=</span> <span class="n">Runtime</span><span class="o">.</span><span class="n">create_from_registry</span><span class="p">(</span>
                    <span class="nb">type</span><span class="o">=</span><span class="n">type_name</span><span class="p">,</span> <span class="o">**</span><span class="n">runtime_value</span>
                <span class="p">)</span>
            <span class="n">out</span><span class="p">[</span><span class="n">runtime_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">runtime_value</span>
        <span class="k">return</span> <span class="n">out</span>

    <span class="nd">@model_validator</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;after&quot;</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">verify_input_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Verifies that the input parameters are valid.&quot;&quot;&quot;</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">_raise_default_runtime_error</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">runtime</span><span class="p">,</span> <span class="n">runtimes</span><span class="p">,</span> <span class="n">default_value</span><span class="p">):</span>
            <span class="n">print_error</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;The Agent.</span><span class="si">{</span><span class="n">runtime</span><span class="si">}</span><span class="s2"> is set to </span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2">, &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;but this runtime is not available in the list: </span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">runtimes</span><span class="p">)</span><span class="si">}</span><span class="s2">. &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;Please choose one of the available runtimes and initialize the agent again, for example:</span><span class="se">\n\n</span><span class="s2">&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;agent = Agent(..., </span><span class="si">{</span><span class="n">runtime</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">default_value</span><span class="si">}</span><span class="s2">&#39;)</span><span class="se">\n\n</span><span class="s2">&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;Make sure the default runtime is available in the list of runtimes. For example:</span><span class="se">\n\n</span><span class="s2">&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;agent = Agent(..., runtimes=</span><span class="se">{{</span><span class="s2">&#39;</span><span class="si">{</span><span class="n">default_value</span><span class="si">}</span><span class="s2">&#39;: OpenAIRuntime(model=&#39;gpt-4&#39;)</span><span class="se">}}</span><span class="s2">)</span><span class="se">\n\n</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;default runtime </span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2"> not found in provided runtimes.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_runtime</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtimes</span><span class="p">:</span>
            <span class="n">_raise_default_runtime_error</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">default_runtime</span><span class="p">,</span> <span class="s2">&quot;default_runtime&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtimes</span><span class="p">,</span> <span class="s2">&quot;openai&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_teacher_runtime</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">teacher_runtimes</span><span class="p">:</span>
            <span class="n">_raise_default_runtime_error</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">default_teacher_runtime</span><span class="p">,</span>
                <span class="s2">&quot;default_teacher_runtime&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">teacher_runtimes</span><span class="p">,</span>
                <span class="s2">&quot;openai-gpt4&quot;</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_runtime</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">runtime</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Runtime</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves the specified runtime or the default runtime if none is specified.</span>

<span class="sd">        Args:</span>
<span class="sd">            runtime (str, optional): The name of the runtime to retrieve. Defaults to None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Runtime: The requested runtime.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If the specified runtime is not found.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">runtime</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">runtime</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_runtime</span>
        <span class="k">if</span> <span class="n">runtime</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtimes</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Runtime &quot;</span><span class="si">{</span><span class="n">runtime</span><span class="si">}</span><span class="s1">&quot; not found.&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtimes</span><span class="p">[</span><span class="n">runtime</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_teacher_runtime</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">runtime</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Runtime</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Retrieves the specified teacher runtime or the default runtime if none is specified.</span>

<span class="sd">        Args:</span>
<span class="sd">            runtime (str, optional): The name of the runtime to retrieve. Defaults to None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Runtime: The requested runtime.</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: If the specified runtime is not found.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">runtime</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">runtime</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_teacher_runtime</span>
        <span class="k">if</span> <span class="n">runtime</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">teacher_runtimes</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Teacher Runtime &quot;</span><span class="si">{</span><span class="n">runtime</span><span class="si">}</span><span class="s1">&quot; not found.&#39;</span><span class="p">)</span>
        <span class="n">runtime</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">teacher_runtimes</span><span class="p">[</span><span class="n">runtime</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">runtime</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Teacher Runtime is requested, but it was not set.&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;Please provide a teacher runtime in the agent&#39;s constructor explicitly:&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;agent = Agent(..., teacher_runtimes=</span><span class="se">{{</span><span class="s2">&#39;default&#39;: OpenAIChatRuntime(model=&#39;gpt-4&#39;)</span><span class="se">}}</span><span class="s2">)&quot;</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="n">runtime</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="nb">input</span><span class="p">:</span> <span class="n">InternalDataFrame</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">runtime</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">InternalDataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs the agent on the specified dataset.</span>

<span class="sd">        Args:</span>
<span class="sd">            input (InternalDataFrame): The dataset to run the agent on.</span>
<span class="sd">            runtime (str, optional): The name of the runtime to use. Defaults to None, use the default runtime.</span>
<span class="sd">            kwargs: Additional keyword arguments to pass to the runtime.</span>
<span class="sd">        Returns:</span>
<span class="sd">            InternalDataFrame: The dataset with the agent&#39;s predictions.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">input</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;input is None and no environment is set.&quot;</span><span class="p">)</span>
            <span class="nb">input</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="o">.</span><span class="n">get_data_batch</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
        <span class="n">runtime</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_runtime</span><span class="p">(</span><span class="n">runtime</span><span class="o">=</span><span class="n">runtime</span><span class="p">)</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">skills</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">runtime</span><span class="o">=</span><span class="n">runtime</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">predictions</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">arun</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="nb">input</span><span class="p">:</span> <span class="n">InternalDataFrame</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">runtime</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">InternalDataFrame</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Runs the agent on the specified input asynchronously.</span>
<span class="sd">        If no input is specified, the agent will run on the environment until it is exhausted.</span>
<span class="sd">        If input is specified, the agent will run on the input, ignoring the connected genvironment.</span>

<span class="sd">        Args:</span>
<span class="sd">            input (InternalDataFrame): The dataset to run the agent on.</span>
<span class="sd">            runtime (str, optional): The name of the runtime to use. Defaults to None, use the default runtime.</span>

<span class="sd">        Returns:</span>
<span class="sd">            InternalDataFrame: The dataset with the agent&#39;s predictions.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">runtime</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_runtime</span><span class="p">(</span><span class="n">runtime</span><span class="o">=</span><span class="n">runtime</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">runtime</span><span class="p">,</span> <span class="n">AsyncRuntime</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;When using asynchronous run with `agent.arun()`, the runtime must be an AsyncRuntime.&quot;</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Using runtime </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">runtime</span><span class="p">))</span>

        <span class="k">if</span> <span class="nb">input</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;input is None and no environment is set.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">,</span> <span class="n">AsyncEnvironment</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;When using asynchronous run with `agent.arun()` and noe input, the environment must be an AsyncEnvironment.&quot;</span>
                <span class="p">)</span>
            <span class="c1"># run on the environment until it is exhausted</span>
            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">data_batch</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="o">.</span><span class="n">get_data_batch</span><span class="p">(</span>
                        <span class="n">batch_size</span><span class="o">=</span><span class="n">runtime</span><span class="o">.</span><span class="n">batch_size</span>
                    <span class="p">)</span>
                    <span class="k">if</span> <span class="n">data_batch</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
                        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;No more data in the environment. Exiting.&quot;</span><span class="p">)</span>
                        <span class="k">break</span>
                <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="c1"># TODO: environment should raise a specific exception + log error</span>
                    <span class="n">print_error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error getting data batch from environment: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">break</span>
                <span class="n">predictions</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">skills</span><span class="o">.</span><span class="n">aapply</span><span class="p">(</span><span class="n">data_batch</span><span class="p">,</span> <span class="n">runtime</span><span class="o">=</span><span class="n">runtime</span><span class="p">)</span>
                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="o">.</span><span class="n">set_predictions</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># single run on the input data</span>
            <span class="n">predictions</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">skills</span><span class="o">.</span><span class="n">aapply</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">runtime</span><span class="o">=</span><span class="n">runtime</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">predictions</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">select_skill_to_train</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">feedback</span><span class="p">:</span> <span class="n">EnvironmentFeedback</span><span class="p">,</span> <span class="n">accuracy_threshold</span><span class="p">:</span> <span class="nb">float</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Selects the skill to train based on the feedback signal.</span>

<span class="sd">        Args:</span>
<span class="sd">            feedback (Feedback): The feedback signal.</span>
<span class="sd">            accuracy_threshold (float): The accuracy threshold to use for selecting the skill to train.</span>

<span class="sd">        Returns:</span>
<span class="sd">            str: The name of the skill to train.</span>
<span class="sd">            str: The name of the skill output to train.</span>
<span class="sd">            float: The accuracy score of the skill to train.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Use ground truth signal to find the skill to improve</span>
        <span class="c1"># TODO: what if it is not possible to estimate accuracy per skill?</span>
        <span class="n">accuracy</span> <span class="o">=</span> <span class="n">feedback</span><span class="o">.</span><span class="n">get_accuracy</span><span class="p">()</span>
        <span class="n">train_skill_name</span><span class="p">,</span> <span class="n">train_skill_output</span><span class="p">,</span> <span class="n">acc_score</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">skill_output</span><span class="p">,</span> <span class="n">skill_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">skills</span><span class="o">.</span><span class="n">get_skill_outputs</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">skill_output</span> <span class="ow">in</span> <span class="n">accuracy</span> <span class="ow">and</span> <span class="n">accuracy</span><span class="p">[</span><span class="n">skill_output</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">accuracy_threshold</span><span class="p">:</span>
                <span class="n">train_skill_name</span><span class="p">,</span> <span class="n">train_skill_output</span> <span class="o">=</span> <span class="n">skill_name</span><span class="p">,</span> <span class="n">skill_output</span>
                <span class="n">acc_score</span> <span class="o">=</span> <span class="n">accuracy</span><span class="p">[</span><span class="n">skill_output</span><span class="p">]</span>
                <span class="k">break</span>

        <span class="k">return</span> <span class="n">train_skill_name</span><span class="p">,</span> <span class="n">train_skill_output</span><span class="p">,</span> <span class="n">acc_score</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">learn</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">learning_iterations</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
        <span class="n">accuracy_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.9</span><span class="p">,</span>
        <span class="n">update_memory</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
        <span class="n">batch_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">num_feedbacks</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">runtime</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">teacher_runtime</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Enables the agent to learn and improve its skills based on interactions with its environment.</span>

<span class="sd">        Args:</span>
<span class="sd">            learning_iterations (int, optional): The number of iterations for learning. Defaults to 3.</span>
<span class="sd">            accuracy_threshold (float, optional): The desired accuracy threshold to reach. Defaults to 0.9.</span>
<span class="sd">            update_memory (bool, optional): Flag to determine if memory should be updated after learning. Defaults to True.</span>
<span class="sd">            num_feedbacks (int, optional): The number of predictions to request feedback for. Defaults to None.</span>
<span class="sd">            runtime (str, optional): The runtime to be used for the learning process. Defaults to None.</span>
<span class="sd">            teacher_runtime (str, optional): The teacher runtime to be used for the learning process. Defaults to None.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">runtime</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_runtime</span><span class="p">(</span><span class="n">runtime</span><span class="o">=</span><span class="n">runtime</span><span class="p">)</span>
        <span class="n">teacher_runtime</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_teacher_runtime</span><span class="p">(</span><span class="n">runtime</span><span class="o">=</span><span class="n">teacher_runtime</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">iteration</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">learning_iterations</span><span class="p">):</span>
            <span class="n">print_text</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">=&gt; Iteration #</span><span class="si">{</span><span class="n">iteration</span><span class="si">}</span><span class="s2">: Getting feedback, analyzing and improving ...&quot;</span>
            <span class="p">)</span>

            <span class="n">inputs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="o">.</span><span class="n">get_data_batch</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">)</span>
            <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">skills</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">runtime</span><span class="o">=</span><span class="n">runtime</span><span class="p">)</span>
            <span class="n">feedback</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="o">.</span><span class="n">get_feedback</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">skills</span><span class="p">,</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">num_feedbacks</span><span class="o">=</span><span class="n">num_feedbacks</span>
            <span class="p">)</span>
            <span class="c1"># TODO: this is just pretty printing - remove later for efficiency</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Predictions and feedback:&quot;</span><span class="p">)</span>
            <span class="n">print_dataframe</span><span class="p">(</span>
                <span class="n">feedback</span><span class="o">.</span><span class="n">feedback</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
                    <span class="n">columns</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="s2">&quot;__fb&quot;</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">predictions</span><span class="o">.</span><span class="n">columns</span> <span class="k">else</span> <span class="n">x</span>
                <span class="p">)</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">left_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="c1"># -----------------------------</span>
            <span class="n">skill_mismatch</span> <span class="o">=</span> <span class="n">feedback</span><span class="o">.</span><span class="n">match</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span>
            <span class="n">has_errors</span> <span class="o">=</span> <span class="n">skill_mismatch</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">has_errors</span><span class="p">:</span>
                <span class="n">print_text</span><span class="p">(</span><span class="s2">&quot;No errors found!&quot;</span><span class="p">)</span>
                <span class="k">continue</span>
            <span class="n">first_skill_with_errors</span> <span class="o">=</span> <span class="n">skill_mismatch</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()</span>

            <span class="n">accuracy</span> <span class="o">=</span> <span class="n">feedback</span><span class="o">.</span><span class="n">get_accuracy</span><span class="p">()</span>
            <span class="c1"># TODO: iterating over skill can be more complex, and we should take order into account</span>
            <span class="k">for</span> <span class="n">skill_output</span><span class="p">,</span> <span class="n">skill_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">skills</span><span class="o">.</span><span class="n">get_skill_outputs</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="n">skill</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">skills</span><span class="p">[</span><span class="n">skill_name</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">skill</span><span class="o">.</span><span class="n">frozen</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="n">print_text</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s1">&#39;Skill output to improve: &quot;</span><span class="si">{</span><span class="n">skill_output</span><span class="si">}</span><span class="s1">&quot; (Skill=&quot;</span><span class="si">{</span><span class="n">skill_name</span><span class="si">}</span><span class="s1">&quot;)</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="sa">f</span><span class="s2">&quot;Accuracy = </span><span class="si">{</span><span class="n">accuracy</span><span class="p">[</span><span class="n">skill_output</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">,</span>
                    <span class="n">style</span><span class="o">=</span><span class="s2">&quot;bold red&quot;</span><span class="p">,</span>
                <span class="p">)</span>

                <span class="n">old_instructions</span> <span class="o">=</span> <span class="n">skill</span><span class="o">.</span><span class="n">instructions</span>
                <span class="n">skill</span><span class="o">.</span><span class="n">improve</span><span class="p">(</span>
                    <span class="n">predictions</span><span class="p">,</span> <span class="n">skill_output</span><span class="p">,</span> <span class="n">feedback</span><span class="p">,</span> <span class="n">runtime</span><span class="o">=</span><span class="n">teacher_runtime</span>
                <span class="p">)</span>

                <span class="k">if</span> <span class="n">is_running_in_jupyter</span><span class="p">():</span>
                    <span class="n">highlight_differences</span><span class="p">(</span><span class="n">old_instructions</span><span class="p">,</span> <span class="n">skill</span><span class="o">.</span><span class="n">instructions</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">print_text</span><span class="p">(</span><span class="n">skill</span><span class="o">.</span><span class="n">instructions</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;bold green&quot;</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">skill_name</span> <span class="o">==</span> <span class="n">first_skill_with_errors</span><span class="p">:</span>
                    <span class="k">break</span>

        <span class="n">print_text</span><span class="p">(</span><span class="s2">&quot;Train is done!&quot;</span><span class="p">)</span>

    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">arefine_skill</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">skill_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">input_variables</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
        <span class="n">data</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">reapply</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">instructions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ImprovedPromptResponse</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        beta v2 of Agent.learn() that is:</span>
<span class="sd">        - compatible with the newer LiteLLM runtimes</span>
<span class="sd">        - compatible with the newer response_model output formats for skills</span>
<span class="sd">        - returns chain of thought reasoning in a legible format</span>

<span class="sd">        Limitations so far:</span>
<span class="sd">        - single skill at a time</span>
<span class="sd">        - only returns the improved input_template, doesn&#39;t modify the skill in place</span>
<span class="sd">        - no iterations/variable cost</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">skill</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">skills</span><span class="p">[</span><span class="n">skill_name</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">skill</span><span class="p">,</span> <span class="n">TransformSkill</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Skill </span><span class="si">{</span><span class="n">skill_name</span><span class="si">}</span><span class="s2"> is not a TransformSkill&quot;</span><span class="p">)</span>

        <span class="c1"># get default runtimes</span>
        <span class="n">runtime</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_runtime</span><span class="p">()</span>
        <span class="n">teacher_runtime</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_teacher_runtime</span><span class="p">()</span>

        <span class="c1"># get inputs</span>
        <span class="c1"># TODO: replace it with async environment.get_data_batch()</span>
        <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">predictions</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">inputs</span> <span class="o">=</span> <span class="n">InternalDataFrame</span><span class="o">.</span><span class="n">from_records</span><span class="p">(</span><span class="n">data</span> <span class="ow">or</span> <span class="p">[])</span>
            <span class="k">if</span> <span class="n">reapply</span><span class="p">:</span>
                <span class="n">predictions</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">skills</span><span class="o">.</span><span class="n">aapply</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">runtime</span><span class="o">=</span><span class="n">runtime</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">predictions</span> <span class="o">=</span> <span class="n">inputs</span>

        <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">skill</span><span class="o">.</span><span class="n">aimprove</span><span class="p">(</span>
            <span class="n">predictions</span><span class="o">=</span><span class="n">predictions</span><span class="p">,</span>
            <span class="n">teacher_runtime</span><span class="o">=</span><span class="n">teacher_runtime</span><span class="p">,</span>
            <span class="n">target_input_variables</span><span class="o">=</span><span class="n">input_variables</span><span class="p">,</span>
            <span class="n">instructions</span><span class="o">=</span><span class="n">instructions</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="adala.agents.base.Agent.__rich__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__rich__</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns a colorized and formatted representation of the Agent instance.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A rich-formatted representation of the agent.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>adala/agents/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">__rich__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a colorized and formatted representation of the Agent instance.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: A rich-formatted representation of the agent.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">skill_names</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">skill</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">skill</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">skills</span><span class="o">.</span><span class="n">skills</span><span class="o">.</span><span class="n">values</span><span class="p">()])</span>
    <span class="n">runtime_names</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">runtimes</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="k">return</span> <span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;[bold blue]Agent Instance[/bold blue]</span><span class="se">\n\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;Environment: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;Skills: </span><span class="si">{</span><span class="n">skill_names</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;Runtimes: </span><span class="si">{</span><span class="n">runtime_names</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;Default Runtime: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">default_runtime</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
        <span class="sa">f</span><span class="s2">&quot;Default Teacher Runtime: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">default_teacher_runtime</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="adala.agents.base.Agent.arefine_skill" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">arefine_skill</span><span class="p">(</span><span class="n">skill_name</span><span class="p">,</span> <span class="n">input_variables</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">reapply</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">instructions</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>beta v2 of Agent.learn() that is:
- compatible with the newer LiteLLM runtimes
- compatible with the newer response_model output formats for skills
- returns chain of thought reasoning in a legible format</p>
<p>Limitations so far:
- single skill at a time
- only returns the improved input_template, doesn't modify the skill in place
- no iterations/variable cost</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>adala/agents/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">arefine_skill</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">skill_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">input_variables</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">reapply</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">instructions</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ImprovedPromptResponse</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    beta v2 of Agent.learn() that is:</span>
<span class="sd">    - compatible with the newer LiteLLM runtimes</span>
<span class="sd">    - compatible with the newer response_model output formats for skills</span>
<span class="sd">    - returns chain of thought reasoning in a legible format</span>

<span class="sd">    Limitations so far:</span>
<span class="sd">    - single skill at a time</span>
<span class="sd">    - only returns the improved input_template, doesn&#39;t modify the skill in place</span>
<span class="sd">    - no iterations/variable cost</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">skill</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">skills</span><span class="p">[</span><span class="n">skill_name</span><span class="p">]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">skill</span><span class="p">,</span> <span class="n">TransformSkill</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Skill </span><span class="si">{</span><span class="n">skill_name</span><span class="si">}</span><span class="s2"> is not a TransformSkill&quot;</span><span class="p">)</span>

    <span class="c1"># get default runtimes</span>
    <span class="n">runtime</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_runtime</span><span class="p">()</span>
    <span class="n">teacher_runtime</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_teacher_runtime</span><span class="p">()</span>

    <span class="c1"># get inputs</span>
    <span class="c1"># TODO: replace it with async environment.get_data_batch()</span>
    <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">inputs</span> <span class="o">=</span> <span class="n">InternalDataFrame</span><span class="o">.</span><span class="n">from_records</span><span class="p">(</span><span class="n">data</span> <span class="ow">or</span> <span class="p">[])</span>
        <span class="k">if</span> <span class="n">reapply</span><span class="p">:</span>
            <span class="n">predictions</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">skills</span><span class="o">.</span><span class="n">aapply</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">runtime</span><span class="o">=</span><span class="n">runtime</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">predictions</span> <span class="o">=</span> <span class="n">inputs</span>

    <span class="n">response</span> <span class="o">=</span> <span class="k">await</span> <span class="n">skill</span><span class="o">.</span><span class="n">aimprove</span><span class="p">(</span>
        <span class="n">predictions</span><span class="o">=</span><span class="n">predictions</span><span class="p">,</span>
        <span class="n">teacher_runtime</span><span class="o">=</span><span class="n">teacher_runtime</span><span class="p">,</span>
        <span class="n">target_input_variables</span><span class="o">=</span><span class="n">input_variables</span><span class="p">,</span>
        <span class="n">instructions</span><span class="o">=</span><span class="n">instructions</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">response</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="adala.agents.base.Agent.arun" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">arun</span><span class="p">(</span><span class="nb">input</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">runtime</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-async"><code>async</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Runs the agent on the specified input asynchronously.
If no input is specified, the agent will run on the environment until it is exhausted.
If input is specified, the agent will run on the input, ignoring the connected genvironment.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>input</code>
            </td>
            <td>
                  <code><span title="adala.utils.internal_data.InternalDataFrame">InternalDataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dataset to run the agent on.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>runtime</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the runtime to use. Defaults to None, use the default runtime.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>InternalDataFrame</code></td>            <td>
                  <code><span title="typing.Optional">Optional</span>[<span title="adala.utils.internal_data.InternalDataFrame">InternalDataFrame</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dataset with the agent's predictions.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>adala/agents/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">arun</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="nb">input</span><span class="p">:</span> <span class="n">InternalDataFrame</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">runtime</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">InternalDataFrame</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Runs the agent on the specified input asynchronously.</span>
<span class="sd">    If no input is specified, the agent will run on the environment until it is exhausted.</span>
<span class="sd">    If input is specified, the agent will run on the input, ignoring the connected genvironment.</span>

<span class="sd">    Args:</span>
<span class="sd">        input (InternalDataFrame): The dataset to run the agent on.</span>
<span class="sd">        runtime (str, optional): The name of the runtime to use. Defaults to None, use the default runtime.</span>

<span class="sd">    Returns:</span>
<span class="sd">        InternalDataFrame: The dataset with the agent&#39;s predictions.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">runtime</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_runtime</span><span class="p">(</span><span class="n">runtime</span><span class="o">=</span><span class="n">runtime</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">runtime</span><span class="p">,</span> <span class="n">AsyncRuntime</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="s2">&quot;When using asynchronous run with `agent.arun()`, the runtime must be an AsyncRuntime.&quot;</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Using runtime </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">runtime</span><span class="p">))</span>

    <span class="k">if</span> <span class="nb">input</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;input is None and no environment is set.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="p">,</span> <span class="n">AsyncEnvironment</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;When using asynchronous run with `agent.arun()` and noe input, the environment must be an AsyncEnvironment.&quot;</span>
            <span class="p">)</span>
        <span class="c1"># run on the environment until it is exhausted</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">data_batch</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="o">.</span><span class="n">get_data_batch</span><span class="p">(</span>
                    <span class="n">batch_size</span><span class="o">=</span><span class="n">runtime</span><span class="o">.</span><span class="n">batch_size</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="n">data_batch</span><span class="o">.</span><span class="n">empty</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;No more data in the environment. Exiting.&quot;</span><span class="p">)</span>
                    <span class="k">break</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                <span class="c1"># TODO: environment should raise a specific exception + log error</span>
                <span class="n">print_error</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Error getting data batch from environment: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">break</span>
            <span class="n">predictions</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">skills</span><span class="o">.</span><span class="n">aapply</span><span class="p">(</span><span class="n">data_batch</span><span class="p">,</span> <span class="n">runtime</span><span class="o">=</span><span class="n">runtime</span><span class="p">)</span>
            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="o">.</span><span class="n">set_predictions</span><span class="p">(</span><span class="n">predictions</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># single run on the input data</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">skills</span><span class="o">.</span><span class="n">aapply</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">runtime</span><span class="o">=</span><span class="n">runtime</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">predictions</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="adala.agents.base.Agent.environment_validator" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">environment_validator</span><span class="p">(</span><span class="n">v</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Validates and possibly transforms the environment attribute:
if the environment is an InternalDataFrame, it is transformed into a StaticEnvironment.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>adala/agents/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@field_validator</span><span class="p">(</span><span class="s2">&quot;environment&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;before&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">environment_validator</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Environment</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Validates and possibly transforms the environment attribute:</span>
<span class="sd">    if the environment is an InternalDataFrame, it is transformed into a StaticEnvironment.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Validating environment attribute: </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">InternalDataFrame</span><span class="p">):</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">StaticEnvironment</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">v</span><span class="p">)</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">and</span> <span class="s2">&quot;type&quot;</span> <span class="ow">in</span> <span class="n">v</span><span class="p">:</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">Environment</span><span class="o">.</span><span class="n">create_from_registry</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">),</span> <span class="o">**</span><span class="n">v</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">v</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="adala.agents.base.Agent.get_runtime" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_runtime</span><span class="p">(</span><span class="n">runtime</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Retrieves the specified runtime or the default runtime if none is specified.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>runtime</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the runtime to retrieve. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Runtime</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="Runtime (adala.runtimes.base.Runtime)" href="../runtimes/#adala.runtimes.base.Runtime">Runtime</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The requested runtime.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the specified runtime is not found.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>adala/agents/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_runtime</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">runtime</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Runtime</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieves the specified runtime or the default runtime if none is specified.</span>

<span class="sd">    Args:</span>
<span class="sd">        runtime (str, optional): The name of the runtime to retrieve. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Runtime: The requested runtime.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the specified runtime is not found.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">runtime</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">runtime</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_runtime</span>
    <span class="k">if</span> <span class="n">runtime</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtimes</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Runtime &quot;</span><span class="si">{</span><span class="n">runtime</span><span class="si">}</span><span class="s1">&quot; not found.&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtimes</span><span class="p">[</span><span class="n">runtime</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="adala.agents.base.Agent.get_teacher_runtime" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_teacher_runtime</span><span class="p">(</span><span class="n">runtime</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Retrieves the specified teacher runtime or the default runtime if none is specified.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>runtime</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the runtime to retrieve. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Runtime</code></td>            <td>
                  <code><a class="autorefs autorefs-internal" title="Runtime (adala.runtimes.base.Runtime)" href="../runtimes/#adala.runtimes.base.Runtime">Runtime</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The requested runtime.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the specified runtime is not found.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>adala/agents/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_teacher_runtime</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">runtime</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Runtime</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieves the specified teacher runtime or the default runtime if none is specified.</span>

<span class="sd">    Args:</span>
<span class="sd">        runtime (str, optional): The name of the runtime to retrieve. Defaults to None.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Runtime: The requested runtime.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If the specified runtime is not found.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">runtime</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">runtime</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_teacher_runtime</span>
    <span class="k">if</span> <span class="n">runtime</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">teacher_runtimes</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Teacher Runtime &quot;</span><span class="si">{</span><span class="n">runtime</span><span class="si">}</span><span class="s1">&quot; not found.&#39;</span><span class="p">)</span>
    <span class="n">runtime</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">teacher_runtimes</span><span class="p">[</span><span class="n">runtime</span><span class="p">]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">runtime</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Teacher Runtime is requested, but it was not set.&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;Please provide a teacher runtime in the agent&#39;s constructor explicitly:&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;agent = Agent(..., teacher_runtimes=</span><span class="se">{{</span><span class="s2">&#39;default&#39;: OpenAIChatRuntime(model=&#39;gpt-4&#39;)</span><span class="se">}}</span><span class="s2">)&quot;</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">runtime</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="adala.agents.base.Agent.learn" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">learn</span><span class="p">(</span><span class="n">learning_iterations</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">accuracy_threshold</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">update_memory</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">num_feedbacks</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">runtime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">teacher_runtime</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Enables the agent to learn and improve its skills based on interactions with its environment.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>learning_iterations</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of iterations for learning. Defaults to 3.</p>
              </div>
            </td>
            <td>
                  <code>3</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>accuracy_threshold</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The desired accuracy threshold to reach. Defaults to 0.9.</p>
              </div>
            </td>
            <td>
                  <code>0.9</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>update_memory</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Flag to determine if memory should be updated after learning. Defaults to True.</p>
              </div>
            </td>
            <td>
                  <code>True</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>num_feedbacks</code>
            </td>
            <td>
                  <code><span title="int">int</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of predictions to request feedback for. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>runtime</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The runtime to be used for the learning process. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>teacher_runtime</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The teacher runtime to be used for the learning process. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>adala/agents/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">learn</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">learning_iterations</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span>
    <span class="n">accuracy_threshold</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.9</span><span class="p">,</span>
    <span class="n">update_memory</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">num_feedbacks</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">runtime</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">teacher_runtime</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Enables the agent to learn and improve its skills based on interactions with its environment.</span>

<span class="sd">    Args:</span>
<span class="sd">        learning_iterations (int, optional): The number of iterations for learning. Defaults to 3.</span>
<span class="sd">        accuracy_threshold (float, optional): The desired accuracy threshold to reach. Defaults to 0.9.</span>
<span class="sd">        update_memory (bool, optional): Flag to determine if memory should be updated after learning. Defaults to True.</span>
<span class="sd">        num_feedbacks (int, optional): The number of predictions to request feedback for. Defaults to None.</span>
<span class="sd">        runtime (str, optional): The runtime to be used for the learning process. Defaults to None.</span>
<span class="sd">        teacher_runtime (str, optional): The teacher runtime to be used for the learning process. Defaults to None.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">runtime</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_runtime</span><span class="p">(</span><span class="n">runtime</span><span class="o">=</span><span class="n">runtime</span><span class="p">)</span>
    <span class="n">teacher_runtime</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_teacher_runtime</span><span class="p">(</span><span class="n">runtime</span><span class="o">=</span><span class="n">teacher_runtime</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">iteration</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">learning_iterations</span><span class="p">):</span>
        <span class="n">print_text</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">=&gt; Iteration #</span><span class="si">{</span><span class="n">iteration</span><span class="si">}</span><span class="s2">: Getting feedback, analyzing and improving ...&quot;</span>
        <span class="p">)</span>

        <span class="n">inputs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="o">.</span><span class="n">get_data_batch</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">)</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">skills</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">runtime</span><span class="o">=</span><span class="n">runtime</span><span class="p">)</span>
        <span class="n">feedback</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="o">.</span><span class="n">get_feedback</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">skills</span><span class="p">,</span> <span class="n">predictions</span><span class="p">,</span> <span class="n">num_feedbacks</span><span class="o">=</span><span class="n">num_feedbacks</span>
        <span class="p">)</span>
        <span class="c1"># TODO: this is just pretty printing - remove later for efficiency</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Predictions and feedback:&quot;</span><span class="p">)</span>
        <span class="n">print_dataframe</span><span class="p">(</span>
            <span class="n">feedback</span><span class="o">.</span><span class="n">feedback</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span>
                <span class="n">columns</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="s2">&quot;__fb&quot;</span> <span class="k">if</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">predictions</span><span class="o">.</span><span class="n">columns</span> <span class="k">else</span> <span class="n">x</span>
            <span class="p">)</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">left_index</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">right_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="c1"># -----------------------------</span>
        <span class="n">skill_mismatch</span> <span class="o">=</span> <span class="n">feedback</span><span class="o">.</span><span class="n">match</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="kc">False</span>
        <span class="n">has_errors</span> <span class="o">=</span> <span class="n">skill_mismatch</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">has_errors</span><span class="p">:</span>
            <span class="n">print_text</span><span class="p">(</span><span class="s2">&quot;No errors found!&quot;</span><span class="p">)</span>
            <span class="k">continue</span>
        <span class="n">first_skill_with_errors</span> <span class="o">=</span> <span class="n">skill_mismatch</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()</span>

        <span class="n">accuracy</span> <span class="o">=</span> <span class="n">feedback</span><span class="o">.</span><span class="n">get_accuracy</span><span class="p">()</span>
        <span class="c1"># TODO: iterating over skill can be more complex, and we should take order into account</span>
        <span class="k">for</span> <span class="n">skill_output</span><span class="p">,</span> <span class="n">skill_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">skills</span><span class="o">.</span><span class="n">get_skill_outputs</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">skill</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">skills</span><span class="p">[</span><span class="n">skill_name</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">skill</span><span class="o">.</span><span class="n">frozen</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="n">print_text</span><span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;Skill output to improve: &quot;</span><span class="si">{</span><span class="n">skill_output</span><span class="si">}</span><span class="s1">&quot; (Skill=&quot;</span><span class="si">{</span><span class="n">skill_name</span><span class="si">}</span><span class="s1">&quot;)</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="sa">f</span><span class="s2">&quot;Accuracy = </span><span class="si">{</span><span class="n">accuracy</span><span class="p">[</span><span class="n">skill_output</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">,</span>
                <span class="n">style</span><span class="o">=</span><span class="s2">&quot;bold red&quot;</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="n">old_instructions</span> <span class="o">=</span> <span class="n">skill</span><span class="o">.</span><span class="n">instructions</span>
            <span class="n">skill</span><span class="o">.</span><span class="n">improve</span><span class="p">(</span>
                <span class="n">predictions</span><span class="p">,</span> <span class="n">skill_output</span><span class="p">,</span> <span class="n">feedback</span><span class="p">,</span> <span class="n">runtime</span><span class="o">=</span><span class="n">teacher_runtime</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="n">is_running_in_jupyter</span><span class="p">():</span>
                <span class="n">highlight_differences</span><span class="p">(</span><span class="n">old_instructions</span><span class="p">,</span> <span class="n">skill</span><span class="o">.</span><span class="n">instructions</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">print_text</span><span class="p">(</span><span class="n">skill</span><span class="o">.</span><span class="n">instructions</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;bold green&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">skill_name</span> <span class="o">==</span> <span class="n">first_skill_with_errors</span><span class="p">:</span>
                <span class="k">break</span>

    <span class="n">print_text</span><span class="p">(</span><span class="s2">&quot;Train is done!&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="adala.agents.base.Agent.run" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run</span><span class="p">(</span><span class="nb">input</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">runtime</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Runs the agent on the specified dataset.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>input</code>
            </td>
            <td>
                  <code><span title="adala.utils.internal_data.InternalDataFrame">InternalDataFrame</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The dataset to run the agent on.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>runtime</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the runtime to use. Defaults to None, use the default runtime.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>kwargs</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Additional keyword arguments to pass to the runtime.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>
        <p>Returns:
    InternalDataFrame: The dataset with the agent's predictions.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>adala/agents/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="nb">input</span><span class="p">:</span> <span class="n">InternalDataFrame</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">runtime</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">InternalDataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Runs the agent on the specified dataset.</span>

<span class="sd">    Args:</span>
<span class="sd">        input (InternalDataFrame): The dataset to run the agent on.</span>
<span class="sd">        runtime (str, optional): The name of the runtime to use. Defaults to None, use the default runtime.</span>
<span class="sd">        kwargs: Additional keyword arguments to pass to the runtime.</span>
<span class="sd">    Returns:</span>
<span class="sd">        InternalDataFrame: The dataset with the agent&#39;s predictions.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">input</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;input is None and no environment is set.&quot;</span><span class="p">)</span>
        <span class="nb">input</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="o">.</span><span class="n">get_data_batch</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
    <span class="n">runtime</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_runtime</span><span class="p">(</span><span class="n">runtime</span><span class="o">=</span><span class="n">runtime</span><span class="p">)</span>
    <span class="n">predictions</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">skills</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">runtime</span><span class="o">=</span><span class="n">runtime</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">predictions</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="adala.agents.base.Agent.runtimes_validator" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">runtimes_validator</span><span class="p">(</span><span class="n">v</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Validates and creates runtimes</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>adala/agents/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@field_validator</span><span class="p">(</span><span class="s2">&quot;runtimes&quot;</span><span class="p">,</span> <span class="s2">&quot;teacher_runtimes&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;before&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">runtimes_validator</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="n">Runtime</span><span class="p">,</span> <span class="n">AsyncRuntime</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Validates and creates runtimes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">out</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">runtime_name</span><span class="p">,</span> <span class="n">runtime_value</span> <span class="ow">in</span> <span class="n">v</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">runtime_value</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">if</span> <span class="s2">&quot;type&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">runtime_value</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Runtime </span><span class="si">{</span><span class="n">runtime_name</span><span class="si">}</span><span class="s2"> must have a &#39;type&#39; field to specify the runtime type.&quot;</span>
                <span class="p">)</span>
            <span class="n">type_name</span> <span class="o">=</span> <span class="n">runtime_value</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;type&quot;</span><span class="p">)</span>
            <span class="n">runtime_value</span> <span class="o">=</span> <span class="n">Runtime</span><span class="o">.</span><span class="n">create_from_registry</span><span class="p">(</span>
                <span class="nb">type</span><span class="o">=</span><span class="n">type_name</span><span class="p">,</span> <span class="o">**</span><span class="n">runtime_value</span>
            <span class="p">)</span>
        <span class="n">out</span><span class="p">[</span><span class="n">runtime_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">runtime_value</span>
    <span class="k">return</span> <span class="n">out</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="adala.agents.base.Agent.select_skill_to_train" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">select_skill_to_train</span><span class="p">(</span><span class="n">feedback</span><span class="p">,</span> <span class="n">accuracy_threshold</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Selects the skill to train based on the feedback signal.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>feedback</code>
            </td>
            <td>
                  <code><span title="Feedback">Feedback</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The feedback signal.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>accuracy_threshold</code>
            </td>
            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The accuracy threshold to use for selecting the skill to train.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the skill to train.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>str</code></td>            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The name of the skill output to train.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
<td><code>float</code></td>            <td>
                  <code><span title="float">float</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The accuracy score of the skill to train.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>adala/agents/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">select_skill_to_train</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">feedback</span><span class="p">:</span> <span class="n">EnvironmentFeedback</span><span class="p">,</span> <span class="n">accuracy_threshold</span><span class="p">:</span> <span class="nb">float</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Selects the skill to train based on the feedback signal.</span>

<span class="sd">    Args:</span>
<span class="sd">        feedback (Feedback): The feedback signal.</span>
<span class="sd">        accuracy_threshold (float): The accuracy threshold to use for selecting the skill to train.</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: The name of the skill to train.</span>
<span class="sd">        str: The name of the skill output to train.</span>
<span class="sd">        float: The accuracy score of the skill to train.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Use ground truth signal to find the skill to improve</span>
    <span class="c1"># TODO: what if it is not possible to estimate accuracy per skill?</span>
    <span class="n">accuracy</span> <span class="o">=</span> <span class="n">feedback</span><span class="o">.</span><span class="n">get_accuracy</span><span class="p">()</span>
    <span class="n">train_skill_name</span><span class="p">,</span> <span class="n">train_skill_output</span><span class="p">,</span> <span class="n">acc_score</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">skill_output</span><span class="p">,</span> <span class="n">skill_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">skills</span><span class="o">.</span><span class="n">get_skill_outputs</span><span class="p">()</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">skill_output</span> <span class="ow">in</span> <span class="n">accuracy</span> <span class="ow">and</span> <span class="n">accuracy</span><span class="p">[</span><span class="n">skill_output</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">accuracy_threshold</span><span class="p">:</span>
            <span class="n">train_skill_name</span><span class="p">,</span> <span class="n">train_skill_output</span> <span class="o">=</span> <span class="n">skill_name</span><span class="p">,</span> <span class="n">skill_output</span>
            <span class="n">acc_score</span> <span class="o">=</span> <span class="n">accuracy</span><span class="p">[</span><span class="n">skill_output</span><span class="p">]</span>
            <span class="k">break</span>

    <span class="k">return</span> <span class="n">train_skill_name</span><span class="p">,</span> <span class="n">train_skill_output</span><span class="p">,</span> <span class="n">acc_score</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="adala.agents.base.Agent.skills_validator" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">skills_validator</span><span class="p">(</span><span class="n">v</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Validates and possibly transforms the skills attribute.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>adala/agents/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@field_validator</span><span class="p">(</span><span class="s2">&quot;skills&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;before&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">skills_validator</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SkillSet</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Validates and possibly transforms the skills attribute.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">SkillSet</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">v</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">Skill</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">LinearSkillSet</span><span class="p">(</span><span class="n">skills</span><span class="o">=</span><span class="p">[</span><span class="n">v</span><span class="p">])</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">LinearSkillSet</span><span class="p">(</span><span class="n">skills</span><span class="o">=</span><span class="n">v</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;skills must be of type SkillSet or Skill, but received type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="adala.agents.base.Agent.verify_input_parameters" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">verify_input_parameters</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Verifies that the input parameters are valid.</p>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>adala/agents/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@model_validator</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;after&quot;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">verify_input_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Verifies that the input parameters are valid.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_raise_default_runtime_error</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="n">runtime</span><span class="p">,</span> <span class="n">runtimes</span><span class="p">,</span> <span class="n">default_value</span><span class="p">):</span>
        <span class="n">print_error</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;The Agent.</span><span class="si">{</span><span class="n">runtime</span><span class="si">}</span><span class="s2"> is set to </span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2">, &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;but this runtime is not available in the list: </span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">runtimes</span><span class="p">)</span><span class="si">}</span><span class="s2">. &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;Please choose one of the available runtimes and initialize the agent again, for example:</span><span class="se">\n\n</span><span class="s2">&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;agent = Agent(..., </span><span class="si">{</span><span class="n">runtime</span><span class="si">}</span><span class="s2">=&#39;</span><span class="si">{</span><span class="n">default_value</span><span class="si">}</span><span class="s2">&#39;)</span><span class="se">\n\n</span><span class="s2">&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;Make sure the default runtime is available in the list of runtimes. For example:</span><span class="se">\n\n</span><span class="s2">&quot;</span>
            <span class="sa">f</span><span class="s2">&quot;agent = Agent(..., runtimes=</span><span class="se">{{</span><span class="s2">&#39;</span><span class="si">{</span><span class="n">default_value</span><span class="si">}</span><span class="s2">&#39;: OpenAIRuntime(model=&#39;gpt-4&#39;)</span><span class="se">}}</span><span class="s2">)</span><span class="se">\n\n</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;default runtime </span><span class="si">{</span><span class="n">val</span><span class="si">}</span><span class="s2"> not found in provided runtimes.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_runtime</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtimes</span><span class="p">:</span>
        <span class="n">_raise_default_runtime_error</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">default_runtime</span><span class="p">,</span> <span class="s2">&quot;default_runtime&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">runtimes</span><span class="p">,</span> <span class="s2">&quot;openai&quot;</span>
        <span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_teacher_runtime</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">teacher_runtimes</span><span class="p">:</span>
        <span class="n">_raise_default_runtime_error</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">default_teacher_runtime</span><span class="p">,</span>
            <span class="s2">&quot;default_teacher_runtime&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">teacher_runtimes</span><span class="p">,</span>
            <span class="s2">&quot;openai-gpt4&quot;</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="adala.agents.base.create_agent_from_dict" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_agent_from_dict</span><span class="p">(</span><span class="n">json_dict</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Creates an agent from a JSON dictionary.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>json_dict</code>
            </td>
            <td>
                  <code><span title="typing.Dict">Dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The JSON dictionary to create the agent from.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Agent</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The created agent.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>adala/agents/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_agent_from_dict</span><span class="p">(</span><span class="n">json_dict</span><span class="p">:</span> <span class="n">Dict</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates an agent from a JSON dictionary.</span>

<span class="sd">    Args:</span>
<span class="sd">        json_dict (Dict): The JSON dictionary to create the agent from.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Agent: The created agent.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">agent</span> <span class="o">=</span> <span class="n">Agent</span><span class="p">(</span><span class="o">**</span><span class="n">json_dict</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">agent</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="adala.agents.base.create_agent_from_file" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_agent_from_file</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Creates an agent from a YAML file:
1. Define agent reasoning workflow in <code>workflow.yml</code>:</p>
<pre><code class="language-yaml">- name: reasoning
  type: sample_transform
  sample_size: 10
  instructions: &quot;Think step-by-step.&quot;
  input_template: &quot;Question: {question}&quot;
  output_template: &quot;{reasoning}&quot;

- name: numeric_answer
  type: transform
  instructions: &gt;
    Given math question and reasoning, provide only numeric answer after `Answer: `, for example:
    Question: &lt;math question&gt;
    Reasoning: &lt;reasoning&gt;
    Answer: &lt;your numerical answer&gt;
  input_template: &gt;
    Question: {question}
    Reasoning: {reasoning}
  output_template: &gt;
    Answer: {answer}
</code></pre>
<ol>
<li>Run adala math reasoning workflow on the <code>gsm8k</code> dataset:</li>
</ol>
<pre><code class="language-sh">adala run --input gsm8k --dataset-config main --dataset-split test --workflow workflow.yml
</code></pre>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>file_path</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The path to the YAML file to create the agent from.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Agent</code></td>            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The created agent.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="mkdocstrings-source">
              <summary>Source code in <code>adala/agents/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_agent_from_file</span><span class="p">(</span><span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Creates an agent from a YAML file:</span>
<span class="sd">    1. Define agent reasoning workflow in `workflow.yml`:</span>

<span class="sd">    ```yaml</span>
<span class="sd">    - name: reasoning</span>
<span class="sd">      type: sample_transform</span>
<span class="sd">      sample_size: 10</span>
<span class="sd">      instructions: &quot;Think step-by-step.&quot;</span>
<span class="sd">      input_template: &quot;Question: {question}&quot;</span>
<span class="sd">      output_template: &quot;{reasoning}&quot;</span>

<span class="sd">    - name: numeric_answer</span>
<span class="sd">      type: transform</span>
<span class="sd">      instructions: &gt;</span>
<span class="sd">        Given math question and reasoning, provide only numeric answer after `Answer: `, for example:</span>
<span class="sd">        Question: &lt;math question&gt;</span>
<span class="sd">        Reasoning: &lt;reasoning&gt;</span>
<span class="sd">        Answer: &lt;your numerical answer&gt;</span>
<span class="sd">      input_template: &gt;</span>
<span class="sd">        Question: {question}</span>
<span class="sd">        Reasoning: {reasoning}</span>
<span class="sd">      output_template: &gt;</span>
<span class="sd">        Answer: {answer}</span>
<span class="sd">    ```</span>

<span class="sd">    2. Run adala math reasoning workflow on the `gsm8k` dataset:</span>

<span class="sd">    ```sh</span>
<span class="sd">    adala run --input gsm8k --dataset-config main --dataset-split test --workflow workflow.yml</span>
<span class="sd">    ```</span>

<span class="sd">    Args:</span>
<span class="sd">        file_path (str): The path to the YAML file to create the agent from.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Agent: The created agent.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">json_dict</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">json_dict</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="n">json_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;skills&quot;</span><span class="p">:</span> <span class="n">json_dict</span><span class="p">}</span>
    <span class="k">return</span> <span class="n">create_agent_from_dict</span><span class="p">(</span><span class="n">json_dict</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href=".." class="md-footer__link md-footer__link--prev" aria-label="Previous: Home">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Home
              </div>
            </div>
          </a>
        
        
          
          <a href="../environments/" class="md-footer__link md-footer__link--next" aria-label="Next: Environments">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Environments
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": ["content.code.copy", "content.tabs.link", "content.action.edit", "toc.follow", "toc.integrate", "navigation.top", "navigation.tabs", "navigation.tabs.sticky", "navigation.footer", "navigation.tracking", "navigation.instant", "navigation.indexes", "navigation.expand", "navigation.sections"], "search": "../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>